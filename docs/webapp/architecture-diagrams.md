# Frontend Architecture Diagrams

**Date:** 2025-11-07
**Context:** Visualisations de l'architecture avant/aprÃ¨s refactoring

---

## 1. Architecture Actuelle (Avant Refactoring)

### 1.1 Component Tree

```
App.vue
â”œâ”€â”€ NavigationDrawer
â”‚   â””â”€â”€ Menu Items
â”œâ”€â”€ AppBar (mobile)
â”œâ”€â”€ Router View
â”‚   â””â”€â”€ Images.vue (GOD COMPONENT - 1366 lignes)
â”‚       â”œâ”€â”€ SessionCard.vue (Ã—N)
â”‚       â”œâ”€â”€ SessionFilters.vue (drawer)
â”‚       â””â”€â”€ TagsDialog.vue
â””â”€â”€ Snackbar (global)
```

### 1.2 Data Flow (Current)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Images.vue                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Local State (20+ properties)                       â”‚    â”‚
â”‚  â”‚  - sessions                                        â”‚    â”‚
â”‚  â”‚  - sessionMetadata                                 â”‚    â”‚
â”‚  â”‚  - allImages                                       â”‚    â”‚
â”‚  â”‚  - selectedSession                                 â”‚    â”‚
â”‚  â”‚  - imageDialog, fullscreenOverlay                  â”‚    â”‚
â”‚  â”‚  - filters, allTags                                â”‚    â”‚
â”‚  â”‚  - autoRefresh, imagePollingInterval               â”‚    â”‚
â”‚  â”‚  - intersectionObserver, sessionObserver           â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                           â†“â†‘                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Business Logic (30+ methods)                       â”‚    â”‚
â”‚  â”‚  - loadSessions(), loadSessionImages()             â”‚    â”‚
â”‚  â”‚  - setupLazyLoading(), setupSessionObserver()      â”‚    â”‚
â”‚  â”‚  - startImagePolling(), stopImagePolling()         â”‚    â”‚
â”‚  â”‚  - openImageDialog(), handleKeyNavigation()        â”‚    â”‚
â”‚  â”‚  - refreshSessions(), refreshCurrentSession()      â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                           â†“â†‘                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ API Calls (direct)                                 â”‚    â”‚
â”‚  â”‚  - ApiService.getSessions()                        â”‚    â”‚
â”‚  â”‚  - ApiService.getSessionImages()                   â”‚    â”‚
â”‚  â”‚  - ApiService.getImageMetadata()                   â”‚    â”‚
â”‚  â”‚  - ApiService.updateSessionMetadata()              â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“â†‘
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Vuex Store     â”‚
                    â”‚  (auth, ui)      â”‚
                    â”‚  (unused in      â”‚
                    â”‚   Images.vue!)   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.3 ProblÃ¨mes IdentifiÃ©s

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Images.vue (1366 lignes)                    â”‚
â”‚                                                          â”‚
â”‚  ğŸ”´ ResponsabilitÃ©s multiples:                          â”‚
â”‚    1. Session list rendering                            â”‚
â”‚    2. Image grid rendering                              â”‚
â”‚    3. Session polling (auto-refresh)                    â”‚
â”‚    4. Image polling (5s)                                â”‚
â”‚    5. Lazy loading (IntersectionObserver)               â”‚
â”‚    6. Dialog management (image + fullscreen)            â”‚
â”‚    7. Keyboard navigation                               â”‚
â”‚    8. Filters logic                                     â”‚
â”‚    9. Tags management                                   â”‚
â”‚   10. Metadata CRUD                                     â”‚
â”‚   11. Date/name formatting                              â”‚
â”‚   12. State synchronization                             â”‚
â”‚   13. Error handling                                    â”‚
â”‚                                                          â”‚
â”‚  ğŸ”´ ConsÃ©quences:                                       â”‚
â”‚    - ComplexitÃ© cyclomatique: 25-30 (seuil: 10)        â”‚
â”‚    - Tests impossibles (God Component)                  â”‚
â”‚    - RÃ©utilisation impossible                           â”‚
â”‚    - Modification risquÃ©e (side effects)                â”‚
â”‚    - Onboarding difficile                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. Architecture Cible (AprÃ¨s Refactoring)

### 2.1 Component Tree

```
App.vue
â”œâ”€â”€ NavigationDrawer
â”œâ”€â”€ AppBar (mobile)
â”œâ”€â”€ Router View
â”‚   â””â”€â”€ ImagesView.vue (ORCHESTRATOR - ~150 lignes)
â”‚       â”œâ”€â”€ SessionList.vue
â”‚       â”‚   â”œâ”€â”€ SessionHeader.vue
â”‚       â”‚   â””â”€â”€ SessionCard.vue (Ã—N)
â”‚       â”œâ”€â”€ ImageGrid.vue
â”‚       â”‚   â”œâ”€â”€ ImageGridHeader.vue
â”‚       â”‚   â””â”€â”€ ImageCard.vue (Ã—N via virtual scroll)
â”‚       â”œâ”€â”€ ImageDialog.vue
â”‚       â”‚   â””â”€â”€ ImageMetadata.vue
â”‚       â”œâ”€â”€ ImageFullscreen.vue
â”‚       â””â”€â”€ SessionFilters.vue (drawer)
â””â”€â”€ Snackbar (global)
```

### 2.2 Data Flow (Target)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ImagesView.vue                           â”‚
â”‚                    (Orchestrator)                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Composables (business logic)                       â”‚    â”‚
â”‚  â”‚  const { sessions, ... } = useSessionPolling()     â”‚    â”‚
â”‚  â”‚  const { images, ... } = useImagePolling(session)  â”‚    â”‚
â”‚  â”‚  const { filtered } = useSessionFilters(sessions)  â”‚    â”‚
â”‚  â”‚  const { observe } = useImageLazyLoad()            â”‚    â”‚
â”‚  â”‚  const { enable } = useKeyboardNav(handlers)       â”‚    â”‚
â”‚  â”‚  const { open } = useImageDialog(images)           â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                           â†“â†‘                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Child Components (presentation)                    â”‚    â”‚
â”‚  â”‚  <SessionList :sessions="filtered" />              â”‚    â”‚
â”‚  â”‚  <ImageGrid :images="images" />                    â”‚    â”‚
â”‚  â”‚  <ImageDialog v-model="dialogOpen" />              â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“â†‘
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Pinia Stores   â”‚
                    â”‚                  â”‚
                    â”‚  sessions.js     â”‚
                    â”‚  images.js       â”‚
                    â”‚  auth.js         â”‚
                    â”‚  ui.js           â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“â†‘
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   API Service    â”‚
                    â”‚  (unchanged)     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.3 ResponsabilitÃ©s Claires

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               SÃ©paration des ResponsabilitÃ©s              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                           â”‚
â”‚  ImagesView.vue (~150 lignes)                            â”‚
â”‚    âœ… Orchestration uniquement                           â”‚
â”‚    âœ… Composition de composables                         â”‚
â”‚    âœ… Binding donnÃ©es â†’ UI                               â”‚
â”‚                                                           â”‚
â”‚  Composables/ (6 fichiers)                               â”‚
â”‚    âœ… Business logic rÃ©utilisable                        â”‚
â”‚    âœ… Gestion Ã©tat local                                 â”‚
â”‚    âœ… Side effects (polling, observers)                  â”‚
â”‚                                                           â”‚
â”‚  Components/ (8 fichiers)                                â”‚
â”‚    âœ… PrÃ©sentation pure                                  â”‚
â”‚    âœ… Ã‰vÃ©nements vers parent                             â”‚
â”‚    âœ… Props descendantes                                 â”‚
â”‚                                                           â”‚
â”‚  Stores/ (4 fichiers)                                    â”‚
â”‚    âœ… Ã‰tat global partagÃ©                                â”‚
â”‚    âœ… Actions asynchrones                                â”‚
â”‚    âœ… Getters dÃ©rivÃ©s                                    â”‚
â”‚                                                           â”‚
â”‚  Utils/ (3 fichiers)                                     â”‚
â”‚    âœ… Fonctions pures                                    â”‚
â”‚    âœ… Formatters                                         â”‚
â”‚    âœ… Helpers                                            â”‚
â”‚                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. Composables Architecture

### 3.1 Composable Dependency Graph

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Composables Layer                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  useSessionPolling()                                        â”‚
â”‚    â”œâ”€â†’ ApiService.getSessions()                            â”‚
â”‚    â”œâ”€â†’ ApiService.getSessionCount()                        â”‚
â”‚    â”œâ”€â†’ formatSessionName() (util)                          â”‚
â”‚    â””â”€â†’ useUiStore() (snackbar)                             â”‚
â”‚                                                             â”‚
â”‚  useImagePolling(sessionName: Ref)                          â”‚
â”‚    â”œâ”€â†’ watch(sessionName) â†’ auto-reload                    â”‚
â”‚    â”œâ”€â†’ ApiService.getSessionImages()                       â”‚
â”‚    â”œâ”€â†’ setInterval() â†’ polling 5s                          â”‚
â”‚    â””â”€â†’ useUiStore() (snackbar)                             â”‚
â”‚                                                             â”‚
â”‚  useImageLazyLoad()                                         â”‚
â”‚    â”œâ”€â†’ IntersectionObserver API                            â”‚
â”‚    â”œâ”€â†’ ApiService.getImageAsBlob()                         â”‚
â”‚    â””â”€â†’ Auto-cleanup onBeforeUnmount()                      â”‚
â”‚                                                             â”‚
â”‚  useSessionFilters(sessions: Ref, metadata: Ref)            â”‚
â”‚    â”œâ”€â†’ computed() â†’ filteredSessions                       â”‚
â”‚    â””â”€â†’ Pure filtering logic                                â”‚
â”‚                                                             â”‚
â”‚  useKeyboardNav({ onLeft, onRight, onEscape })             â”‚
â”‚    â”œâ”€â†’ window.addEventListener('keydown')                  â”‚
â”‚    â””â”€â†’ Auto-cleanup onBeforeUnmount()                      â”‚
â”‚                                                             â”‚
â”‚  useImageDialog(images: Ref)                                â”‚
â”‚    â”œâ”€â†’ ApiService.getImageMetadata()                       â”‚
â”‚    â”œâ”€â†’ ApiService.getImageAsBlob() (full size)             â”‚
â”‚    â””â”€â†’ Navigation logic (prev/next)                        â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 Composable Reusability Matrix

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Composable          â”‚ Used In              â”‚ Reusable?    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ useSessionPolling    â”‚ ImagesView.vue       â”‚ âœ… Yes       â”‚
â”‚                      â”‚ (future: HomeView)   â”‚              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ useImagePolling      â”‚ ImagesView.vue       â”‚ âœ… Yes       â”‚
â”‚                      â”‚ (future: Generate)   â”‚              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ useImageLazyLoad     â”‚ ImageGrid.vue        â”‚ âœ… Yes       â”‚
â”‚                      â”‚ (any image list)     â”‚              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ useSessionFilters    â”‚ ImagesView.vue       â”‚ âœ… Yes       â”‚
â”‚                      â”‚ SessionFilters.vue   â”‚              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ useKeyboardNav       â”‚ ImageDialog.vue      â”‚ âœ… Yes       â”‚
â”‚                      â”‚ (any modal)          â”‚              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ useImageDialog       â”‚ ImagesView.vue       â”‚ âœ… Yes       â”‚
â”‚                      â”‚ (future: lightbox)   â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. Component Communication

### 4.1 Props Down, Events Up

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     ImagesView.vue                          â”‚
â”‚                     (Orchestrator)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚                        â”‚
        [Props â†“]                [Props â†“]
               â”‚                        â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚  SessionList.vue â”‚     â”‚  ImageGrid.vue   â”‚
      â”‚                  â”‚     â”‚                  â”‚
      â”‚  Props:          â”‚     â”‚  Props:          â”‚
      â”‚  - sessions      â”‚     â”‚  - images        â”‚
      â”‚  - selected      â”‚     â”‚  - loading       â”‚
      â”‚  - metadata      â”‚     â”‚                  â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚                        â”‚
       [Events â†‘]                [Events â†‘]
               â”‚                        â”‚
               â”œâ”€ @select               â”œâ”€ @image-click
               â”œâ”€ @refresh              â””â”€ @update:tags
               â””â”€ @update-metadata
```

### 4.2 Provide/Inject Pattern (Alternative)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     ImagesView.vue                          â”‚
â”‚                                                             â”‚
â”‚  provide('sessionStore', useSessionStore())                 â”‚
â”‚  provide('imageStore', useImageStore())                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚                        â”‚
        [Provide â†“]              [Provide â†“]
               â”‚                        â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚  SessionList.vue â”‚     â”‚  ImageGrid.vue   â”‚
      â”‚                  â”‚     â”‚                  â”‚
      â”‚  const store =   â”‚     â”‚  const store =   â”‚
      â”‚  inject('...')   â”‚     â”‚  inject('...')   â”‚
      â”‚                  â”‚     â”‚                  â”‚
      â”‚  âœ… No props     â”‚     â”‚  âœ… No props     â”‚
      â”‚  âœ… Direct       â”‚     â”‚  âœ… Direct       â”‚
      â”‚     access       â”‚     â”‚     access       â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Choix recommandÃ©:** Props/Events pour composants rÃ©utilisables, Provide/Inject pour contexte spÃ©cifique.

---

## 5. State Management

### 5.1 Pinia Stores Structure

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       Pinia Stores                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  stores/sessions.js                                         â”‚
â”‚    state: {                                                 â”‚
â”‚      sessions: [],                                          â”‚
â”‚      selectedSession: null,                                 â”‚
â”‚      metadata: {} // sessionName â†’ metadata                 â”‚
â”‚    }                                                        â”‚
â”‚    actions: {                                               â”‚
â”‚      loadSessions(), selectSession(),                       â”‚
â”‚      loadMetadata(), updateMetadata()                       â”‚
â”‚    }                                                        â”‚
â”‚                                                             â”‚
â”‚  stores/images.js                                           â”‚
â”‚    state: {                                                 â”‚
â”‚      images: [],                                            â”‚
â”‚      selectedImage: null,                                   â”‚
â”‚      lastIndex: -1                                          â”‚
â”‚    }                                                        â”‚
â”‚    actions: {                                               â”‚
â”‚      loadImages(), loadThumbnail(),                         â”‚
â”‚      selectImage(), clearImages()                           â”‚
â”‚    }                                                        â”‚
â”‚                                                             â”‚
â”‚  stores/auth.js                                             â”‚
â”‚    state: { user, isAuthenticated }                        â”‚
â”‚    actions: { login(), logout() }                           â”‚
â”‚                                                             â”‚
â”‚  stores/ui.js                                               â”‚
â”‚    state: { loading, snackbar }                            â”‚
â”‚    actions: { showSnackbar(), setLoading() }               â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 State Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      User Action                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  Component Event        â”‚
         â”‚  (e.g., @select)        â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  Composable/Store       â”‚
         â”‚  Action                 â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  API Call               â”‚
         â”‚  (async)                â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  Update State           â”‚
         â”‚  (reactive)             â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  Re-render UI           â”‚
         â”‚  (automatic)            â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 6. Lazy Loading Strategy

### 6.1 IntersectionObserver Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Lazy Loading Architecture                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  1. Component Mount                                         â”‚
â”‚     â†“                                                       â”‚
â”‚  2. useImageLazyLoad() â†’ Setup IntersectionObserver        â”‚
â”‚     â†“                                                       â”‚
â”‚  3. Observe all <div data-image-path="...">                 â”‚
â”‚     â†“                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  â”‚  User scrolls â†’ Image enters viewport â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚             â”‚                                               â”‚
â”‚  4. IntersectionObserver callback fires                     â”‚
â”‚     â†“                                                       â”‚
â”‚  5. loadThumbnail(imagePath)                                â”‚
â”‚     â†“                                                       â”‚
â”‚  6. ApiService.getImageAsBlob(path, thumbnail=true)         â”‚
â”‚     â†“                                                       â”‚
â”‚  7. image.thumbnail = blobURL                               â”‚
â”‚     â†“                                                       â”‚
â”‚  8. Unobserve element (loaded)                              â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 Virtual Scrolling + Lazy Loading

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Virtual Scroll + Lazy Load Combined                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  <RecycleScroller>                                          â”‚
â”‚    â”‚                                                        â”‚
â”‚    â”œâ”€ Renders only visible items (viewport)                â”‚
â”‚    â”‚  â”œâ”€ Item 0   (visible, observer attached)             â”‚
â”‚    â”‚  â”œâ”€ Item 1   (visible, observer attached)             â”‚
â”‚    â”‚  â”œâ”€ Item 2   (visible, observer attached)             â”‚
â”‚    â”‚  â””â”€ ...                                                â”‚
â”‚    â”‚                                                        â”‚
â”‚    â”œâ”€ Items 3-10  (in rootMargin, preload)                 â”‚
â”‚    â”‚                                                        â”‚
â”‚    â””â”€ Items 11+    (not rendered, no observer)             â”‚
â”‚                                                             â”‚
â”‚  Benefits:                                                  â”‚
â”‚    âœ… Only ~10-15 DOM nodes (vs 1000)                      â”‚
â”‚    âœ… Smooth 60 FPS scroll                                 â”‚
â”‚    âœ… Memory efficient                                     â”‚
â”‚    âœ… Preload next images (rootMargin)                     â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 7. Polling Architecture

### 7.1 Multi-Level Polling

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Polling Strategy                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Level 1: Session List Polling (60s)                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ useSessionPolling({ pollInterval: 60000 })     â”‚        â”‚
â”‚  â”‚   â†“                                            â”‚        â”‚
â”‚  â”‚ refreshSessions() every 60s                    â”‚        â”‚
â”‚  â”‚   â”œâ”€ Detect new sessions                       â”‚        â”‚
â”‚  â”‚   â””â”€ Update count of recent session            â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                             â”‚
â”‚  Level 2: Image List Polling (5s)                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ useImagePolling(sessionName, { pollInterval: 5000 })    â”‚
â”‚  â”‚   â†“                                            â”‚        â”‚
â”‚  â”‚ refreshImages() every 5s                       â”‚        â”‚
â”‚  â”‚   â”œâ”€ Fetch images since lastIndex              â”‚        â”‚
â”‚  â”‚   â””â”€ Append new images to list                 â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                             â”‚
â”‚  Benefits:                                                  â”‚
â”‚    âœ… Real-time updates during generation                  â”‚
â”‚    âœ… Efficient (incremental fetch)                        â”‚
â”‚    âœ… Auto-cleanup on unmount                              â”‚
â”‚    âœ… Pause when inactive                                  â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.2 Polling Lifecycle

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Polling Lifecycle                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  1. Component Mount                                         â”‚
â”‚     â†“                                                       â”‚
â”‚  2. useImagePolling(sessionName) â†’ watch(sessionName)       â”‚
â”‚     â†“                                                       â”‚
â”‚  3. sessionName changes â†’ loadImages()                      â”‚
â”‚     â†“                                                       â”‚
â”‚  4. startPolling() â†’ setInterval(refreshImages, 5000)       â”‚
â”‚     â”‚                                                       â”‚
â”‚     â”œâ”€ t=0s:  Initial load (100 images)                    â”‚
â”‚     â”œâ”€ t=5s:  Check for new images (since index 99)        â”‚
â”‚     â”œâ”€ t=10s: Check for new images (since index 102)       â”‚
â”‚     â”œâ”€ t=15s: Check for new images (since index 102)       â”‚
â”‚     â””â”€ ...                                                  â”‚
â”‚     â”‚                                                       â”‚
â”‚  5. User selects different session                          â”‚
â”‚     â†“                                                       â”‚
â”‚  6. stopPolling() â†’ clearInterval()                         â”‚
â”‚     â†“                                                       â”‚
â”‚  7. Restart cycle for new session                           â”‚
â”‚     â”‚                                                       â”‚
â”‚  8. Component Unmount                                       â”‚
â”‚     â†“                                                       â”‚
â”‚  9. onBeforeUnmount() â†’ stopPolling() (cleanup)             â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 8. Testing Strategy

### 8.1 Testing Pyramid

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Testing Pyramid                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚                      E2E Tests                              â”‚
â”‚                     (Playwright)                            â”‚
â”‚                   â•±              â•²                          â”‚
â”‚                  â•±   10% (5-10)   â•²                         â”‚
â”‚                 â•±                  â•²                        â”‚
â”‚                â•±    Integration     â•²                       â”‚
â”‚               â•±    Tests (Vitest)    â•²                      â”‚
â”‚              â•±   20% (15-20 tests)    â•²                     â”‚
â”‚             â•±                          â•²                    â”‚
â”‚            â•±     Unit Tests (Vitest)    â•²                   â”‚
â”‚           â•±    70% (50+ tests)           â•²                  â”‚
â”‚          â•±_________________________________â•²                â”‚
â”‚                                                             â”‚
â”‚  Unit Tests (composables, utils, stores)                    â”‚
â”‚    âœ… useSessionPolling.spec.js (10 tests)                 â”‚
â”‚    âœ… useImagePolling.spec.js (8 tests)                    â”‚
â”‚    âœ… useImageLazyLoad.spec.js (5 tests)                   â”‚
â”‚    âœ… useSessionFilters.spec.js (12 tests)                 â”‚
â”‚    âœ… formatters.spec.js (6 tests)                         â”‚
â”‚    âœ… stores/sessions.spec.js (10 tests)                   â”‚
â”‚                                                             â”‚
â”‚  Integration Tests (components + stores)                    â”‚
â”‚    âœ… SessionList.spec.js (5 tests)                        â”‚
â”‚    âœ… ImageGrid.spec.js (4 tests)                          â”‚
â”‚    âœ… ImageDialog.spec.js (6 tests)                        â”‚
â”‚                                                             â”‚
â”‚  E2E Tests (user flows)                                     â”‚
â”‚    âœ… image-gallery.spec.js (5 scenarios)                  â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 8.2 Test Coverage Goals

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               Coverage Targets by Layer                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Layer           â”‚ Target â”‚ Current â”‚ Priority             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚  Utils           â”‚  95%   â”‚   0%    â”‚  ğŸ”´ P1 (easy)        â”‚
â”‚  Composables     â”‚  90%   â”‚   0%    â”‚  ğŸ”´ P1 (critical)    â”‚
â”‚  Stores          â”‚  85%   â”‚   0%    â”‚  ğŸŸ  P2 (important)   â”‚
â”‚  Components      â”‚  75%   â”‚   0%    â”‚  ğŸŸ¡ P3 (nice-to-have)â”‚
â”‚  Views           â”‚  50%   â”‚   0%    â”‚  ğŸŸ¢ P4 (optional)    â”‚
â”‚                                                             â”‚
â”‚  Total Target:   80% coverage                               â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 9. Performance Metrics

### 9.1 Before vs After (Estimated)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Performance Comparison                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Metric                    â”‚ Before â”‚ After  â”‚ Gain        â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚  Initial load (1st paint)  â”‚  2.5s  â”‚  1.8s  â”‚ -28%       â”‚
â”‚  Grid render (1000 images) â”‚  3.2s  â”‚  0.4s  â”‚ -88% ğŸš€    â”‚
â”‚  Scroll FPS (1000 images)  â”‚  30    â”‚  60    â”‚ +100% ğŸš€   â”‚
â”‚  Memory usage              â”‚  450MB â”‚  180MB â”‚ -60% ğŸš€    â”‚
â”‚  Bundle size               â”‚  420KB â”‚  340KB â”‚ -19%       â”‚
â”‚  Lighthouse Score          â”‚  75    â”‚  95    â”‚ +27%       â”‚
â”‚  Components LOC (avg)      â”‚  1366  â”‚  150   â”‚ -89% ğŸš€    â”‚
â”‚  Complexity (max)          â”‚  30    â”‚  8     â”‚ -73% ğŸš€    â”‚
â”‚  Test coverage             â”‚  0%    â”‚  80%   â”‚ +80% ğŸš€    â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9.2 Key Optimizations

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 Optimization Impact                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  1. Virtual Scrolling                                       â”‚
â”‚     Impact: ğŸš€ğŸš€ğŸš€ (High)                                   â”‚
â”‚     Before: Renders 1000 DOM nodes                          â”‚
â”‚     After:  Renders ~15 DOM nodes                           â”‚
â”‚     Gain:   -88% render time, -60% memory                   â”‚
â”‚                                                             â”‚
â”‚  2. Code Splitting (lazy routes)                            â”‚
â”‚     Impact: ğŸŸ¢ğŸŸ¢ (Medium)                                   â”‚
â”‚     Before: All routes in main bundle                       â”‚
â”‚     After:  Routes loaded on-demand                         â”‚
â”‚     Gain:   -19% initial bundle size                        â”‚
â”‚                                                             â”‚
â”‚  3. Memoization (filters)                                   â”‚
â”‚     Impact: ğŸŸ¢ (Low-Medium)                                 â”‚
â”‚     Before: Recalculate on every render                     â”‚
â”‚     After:  Cache results                                   â”‚
â”‚     Gain:   -30% filter computation time                    â”‚
â”‚                                                             â”‚
â”‚  4. Lazy Loading (images)                                   â”‚
â”‚     Impact: ğŸŸ¢ (Low-Medium)                                 â”‚
â”‚     Before: Load all thumbnails immediately                 â”‚
â”‚     After:  Load on-demand (IntersectionObserver)           â”‚
â”‚     Gain:   -40% initial network requests                   â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 10. Migration Path

### 10.1 Incremental Migration

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               Migration Strategy                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Week 1: Foundation                                         â”‚
â”‚    â”œâ”€ Setup Pinia, ESLint, Vitest                          â”‚
â”‚    â”œâ”€ Extract utils (formatters)                           â”‚
â”‚    â””â”€ Add virtual scrolling                                â”‚
â”‚    âœ… Low risk, immediate benefits                         â”‚
â”‚                                                             â”‚
â”‚  Week 2: Composables                                        â”‚
â”‚    â”œâ”€ Extract business logic                               â”‚
â”‚    â”œâ”€ Write tests (unit)                                   â”‚
â”‚    â””â”€ Refactor Images.vue (use composables)                â”‚
â”‚    ğŸŸ¡ Medium risk, high payoff                             â”‚
â”‚                                                             â”‚
â”‚  Week 3: Components                                         â”‚
â”‚    â”œâ”€ Create atomic components                             â”‚
â”‚    â”œâ”€ Write tests (integration)                            â”‚
â”‚    â””â”€ Simplify Images.vue â†’ orchestrator                   â”‚
â”‚    ğŸŸ  Higher risk, careful testing needed                  â”‚
â”‚                                                             â”‚
â”‚  Week 4: Polish                                             â”‚
â”‚    â”œâ”€ E2E tests                                            â”‚
â”‚    â”œâ”€ Performance audit                                    â”‚
â”‚    â””â”€ Documentation                                        â”‚
â”‚    âœ… Low risk, validation                                 â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 10.2 Feature Flags (Safety)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               Feature Flags Strategy                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  // .env                                                    â”‚
â”‚  VITE_USE_NEW_IMAGE_GRID=false                              â”‚
â”‚  VITE_USE_NEW_SESSION_LIST=false                            â”‚
â”‚  VITE_USE_VIRTUAL_SCROLL=false                              â”‚
â”‚                                                             â”‚
â”‚  // Images.vue                                              â”‚
â”‚  <template>                                                 â”‚
â”‚    <ImageGrid v-if="useNewGrid" />                          â”‚
â”‚    <ImageGridOld v-else />                                  â”‚
â”‚  </template>                                                â”‚
â”‚                                                             â”‚
â”‚  Benefits:                                                  â”‚
â”‚    âœ… Rollback instantanÃ© si problÃ¨me                       â”‚
â”‚    âœ… A/B testing possible                                  â”‚
â”‚    âœ… Migration progressive                                 â”‚
â”‚    âœ… Validation en production                              â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 11. Documentation Strategy

### 11.1 Documentation Structure

```
docs/webapp/
â”œâ”€â”€ frontend-architecture-audit.md       (âœ… Ce document)
â”œâ”€â”€ refactoring-plan.md                  (âœ… Plan dÃ©taillÃ©)
â”œâ”€â”€ architecture-diagrams.md             (âœ… Ce document)
â”œâ”€â”€ api/
â”‚   â””â”€â”€ composables-reference.md         (ğŸ“ Ã€ crÃ©er)
â”œâ”€â”€ guides/
â”‚   â”œâ”€â”€ component-development.md         (ğŸ“ Ã€ crÃ©er)
â”‚   â”œâ”€â”€ testing-guide.md                 (ğŸ“ Ã€ crÃ©er)
â”‚   â””â”€â”€ performance-optimization.md      (ğŸ“ Ã€ crÃ©er)
â””â”€â”€ examples/
    â”œâ”€â”€ creating-composable.md           (ğŸ“ Ã€ crÃ©er)
    â””â”€â”€ testing-patterns.md              (ğŸ“ Ã€ crÃ©er)
```

### 11.2 JSDoc Standards

```javascript
/**
 * Composable pour gÃ©rer le polling des sessions
 *
 * @example
 * ```js
 * const { sessions, loadSessions } = useSessionPolling({
 *   pollInterval: 60000,
 *   autoRefresh: true
 * })
 * ```
 *
 * @param {Object} options - Options de configuration
 * @param {number} [options.pollInterval=60000] - Intervalle de polling (ms)
 * @param {boolean} [options.autoRefresh=false] - Activer l'auto-refresh
 *
 * @returns {Object} Ã‰tat et actions
 * @returns {Ref<Array>} returns.sessions - Liste des sessions
 * @returns {Ref<boolean>} returns.loading - Ã‰tat de chargement
 * @returns {Function} returns.loadSessions - Charge les sessions
 * @returns {Function} returns.refreshSessions - RafraÃ®chit la liste
 *
 * @see {@link https://github.com/.../docs/composables.md|Documentation}
 */
export function useSessionPolling(options = {}) {
  // ...
}
```

---

## Conclusion

Ce document fournit les visualisations architecturales nÃ©cessaires pour comprendre :

1. **Ã‰tat actuel** - ProblÃ¨mes structurels (God Component, responsabilitÃ©s multiples)
2. **Architecture cible** - SÃ©paration claire (Composables, Components, Stores)
3. **StratÃ©gies techniques** - Lazy loading, Virtual scroll, Polling
4. **MÃ©triques de succÃ¨s** - Gains attendus en performance et maintenabilitÃ©
5. **Plan de migration** - Approche incrÃ©mentale avec feature flags

**Prochaines Ã©tapes :**
1. Valider l'architecture cible avec l'Ã©quipe
2. Commencer Phase 1 (Quick Wins)
3. ItÃ©rer progressivement selon le plan

---

**Auteur:** Claude Code
**Date:** 2025-11-07
**Version:** 1.0
